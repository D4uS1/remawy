import u,{useCallback as Ft,useState as wt,useRef as Nn,useMemo as In}from"react";import{createEditor as Sn}from"slate";import{Slate as Bn,Editable as Fn,withReact as wn,ReactEditor as Ln}from"slate-react";import ve from"react";var Te=e=>ve.createElement("pre",{...e.attributes},ve.createElement("code",null,e.children));import At from"react";var He=e=>At.createElement("p",{...e.attributes},e.children);import qt from"react";var Pe=e=>qt.createElement("blockquote",{...e.attributes},e.children);import $t from"react";var Ne=e=>$t.createElement("h1",{...e.attributes},e.children);import Ot from"react";var Ie=e=>Ot.createElement("h2",{...e.attributes},e.children);import Vt from"react";var Se=e=>Vt.createElement("h3",{...e.attributes},e.children);import Dt from"react";var Be=e=>Dt.createElement("h4",{...e.attributes},e.children);import Kt from"react";var Fe=e=>Kt.createElement("h5",{...e.attributes},e.children);import Gt from"react";var we=e=>Gt.createElement("h6",{...e.attributes},e.children);import Rt from"react";var Le=e=>Rt.createElement("ol",{...e.attributes},e.children);import Wt from"react";var Ue=e=>Wt.createElement("ul",{...e.attributes},e.children);import zt from"react";var Me=e=>zt.createElement("li",{...e.attributes},e.children);import{Editor as E,Node as G,Point as Zt,Transforms as C,Text as jt}from"slate";var Ae=(e,t,o)=>{C.setNodes(e,{...o,type:t})},Qt=e=>{let t=ie(e);t&&C.unwrapNodes(e,{at:t})},ie=e=>e.selection?e.selection.anchor.path.slice(0,-1):null,qe=e=>{let t=e.selection?.anchor.path;return t?(t=t.slice(0,-1),G.get(e,t)):null},Yt=e=>{if(!e.selection)return null;let t=qe(e);return t?t.type:null},Jt=(e,t)=>{let o=e.selection?.anchor.path;if(!o)return null;do{let r=G.get(e,o);if(!r)return null;if(r.type===t)return r;o=o?.slice(0,-1)}while(o.length>0);return null},$e=e=>{C.splitNodes(e,{always:!0})},Xt=(e,t,o={})=>{if(C.insertNodes(e,{...o.props,type:t,children:o.children||[{text:""}]},{voids:o.voids}),o.createFollowingParagraph&&C.insertNodes(e,{type:"paragraph",children:[{text:""}]}),o.createFollowingText!==void 0){if(!e.selection)return;let r=E.parent(e,e.selection)[1];r[r.length-1]++,C.insertNodes(e,{text:o.createFollowingText},{at:r}),C.select(e,{anchor:{path:r,offset:o.createFollowingText.length},focus:{path:r,offset:o.createFollowingText.length}})}},eo=(e,t,o={})=>{C.wrapNodes(e,{type:t,...o},{split:!0})},to=e=>{C.liftNodes(e)},oo=e=>{C.unwrapNodes(e)},se=e=>e.selection?Zt.equals(e.selection.anchor,e.selection.focus):!1,Oe=e=>e.selection?!se(e):!1,ae=e=>{let t=E.above(e,{match:r=>E.isBlock(e,r)}),o=t?t[1]:[];return E.start(e,o)},Ve=e=>{let t=E.above(e,{match:r=>E.isBlock(e,r)}),o=t?t[1]:[];return E.end(e,o)},De=e=>{if(!e.selection)return null;let t=ae(e),o={anchor:e.selection.anchor,focus:t};return E.string(e,o)},ro=e=>{if(!e.selection)return null;let t=Ve(e),o={anchor:e.selection.focus,focus:t};return E.string(e,o)},no=(e,t,o)=>{if(!e.selection)return null;let r=me(e);if(!r)return null;let i=r.lastIndexOf(t);return o?.isolated&&(r.substring(i+t.length,i+t.length*2)===t||r.substring(i-t.length,i)===t)||i===-1?null:{path:e.selection.anchor.path,offset:i}},lo=(e,t)=>!e.selection||!se(e)?!1:!!De(e)?.endsWith(t),me=e=>e.selection?E.string(e,{anchor:{path:e.selection.anchor.path,offset:0},focus:e.selection.anchor}):null,Ke=(e,t)=>{if(!e.selection)return;let o=ae(e);o&&(C.delete(e,{at:{anchor:o,focus:e.selection.anchor}}),C.insertText(e,t,{at:o}))},io=(e,t)=>{let o=me(e);o&&(o=o.slice(t),Ke(e,o))},so=(e,t)=>{for(let o=0;o<t;o++)E.deleteBackward(e,{unit:"character"})},ao=(e,t,o)=>{C.delete(e,{at:t,distance:o,unit:"character"})},Ge=(e,t)=>e.selection?E.above(e,{match:o=>t.includes(o.type)})!==void 0:!1,mo=(e,t)=>e.selection?Ge(e,[t]):!1,Re=e=>{if(!e.selection)return null;let t=E.above(e,{match:o=>E.isBlock(e,o)});return!t||!Ze(t[0])?null:t[0]},uo=e=>{if(!e.selection)return null;let t=ie(e);return t?ue(e,t):null},ue=(e,t)=>{let o=t;if(o.length===0)return null;do{let r=G.get(e,o);if(!r)return null;if(E.isBlock(e,r))return o;o=o.slice(0,-1)}while(o.length>0);return null},co=e=>{if(!e.selection)return null;let t=Re(e);return t?t.type:null},We=e=>{if(!e.selection)return null;let t=uo(e);return!t||(t=t.slice(0,-1),t=ue(e,t),!t)?null:G.get(e,t)},po=e=>{let t=We(e);return t?t.type:null},ze=e=>{if(!e.selection)return null;let t=E.node(e,e.selection.anchor);return!t||!je(t[0])?null:t[0]},Ze=e=>{let t=e;return!!(t&&t.type)},je=e=>{let t=e;return!!(t&&t.text)},fo=e=>{let t=e.selection?.anchor||e.selection?.focus;return t?t.path.length<=2:!1},Co=e=>{let t=e,o=e;return!t.text&&!o.type},go=e=>{if(Oe(e)||!e.selection)return!1;let t=ze(e);return t?t.text==="":!0},Eo=e=>{e.selection&&($e(e),Ae(e,"paragraph"),Qe(e))},ho=e=>{C.insertText(e,`
`)},Qe=e=>{for(;!n.isAtRoot(e);)C.liftNodes(e)},bo=(e,t,o)=>{e.selection&&C.setNodes(e,t,{at:o||e.selection,match:r=>jt.isText(r),split:!0})},yo=(e,t,o)=>{C.setNodes(e,o,{match:r=>r.type===t})},n={removeInlineNode:Qt,changeCurrentNodeType:Ae,createNewNode:Xt,createNewNodeOfCurrentType:$e,wrapNode:eo,unwrapNode:to,unwrapLeaf:oo,isCursor:se,isSelection:Oe,nearestBlockPath:ue,currentBlockStart:ae,currentBlockEnd:Ve,textSinceBlockStart:De,textToBlockEnd:ro,lastPosOf:no,cursorIsBehind:lo,currentBlockText:me,setCurrentBlockText:Ke,deleteFromLeft:io,deleteFromRight:so,deleteAt:ao,isChildOf:mo,isChildOfAny:Ge,nearestElementOfType:Jt,currentBlock:Re,currentBlockType:co,currentElement:qe,currentElementType:Yt,currentElementPath:ie,parentBlock:We,parentBlockType:po,currentLeaf:ze,isElement:Ze,isLeaf:je,isRoot:Co,isEmpty:go,isAtRoot:fo,createRootParagraph:Eo,createNewline:ho,liftToRoot:Qe,setLeafFormat:bo,changeNearestNodeProps:yo};import de from"react";var Ye=e=>{let t=de.createElement("span",{...e.attributes},e.children);return e.leaf.bold&&(t=de.createElement("strong",null,t)),e.leaf.italic&&(t=de.createElement("em",null,t)),t};import{Editor as B}from"slate";var Je=e=>!!B.marks(e)?.bold,Xe=e=>!!B.marks(e)?.italic,et=(e,t)=>{e.selection&&n.setLeafFormat(e,{bold:!0},t)},_o=e=>{n.setLeafFormat(e,{bold:void 0})},tt=(e,t)=>{e.selection&&n.setLeafFormat(e,{italic:!0},t)},xo=e=>{n.setLeafFormat(e,{italic:void 0})},ko=e=>{Je(e)?B.removeMark(e,"bold"):B.addMark(e,"bold",!0)},vo=e=>{Xe(e)?B.removeMark(e,"italic"):B.addMark(e,"italic",!0)},To=(e,t)=>{if(["_","*"].includes(t.key))if(n.cursorIsBehind(e,t.key)){let o=n.lastPosOf(e,`${t.key}${t.key}`);if(!o||!e.selection)return;et(e,{anchor:o,focus:e.selection.anchor}),B.addMark(e,"bold",!1),n.deleteAt(e,o,2),n.deleteFromRight(e,1),n.deleteAt(e,e.selection.anchor,1),t.preventDefault()}else{let o=n.lastPosOf(e,t.key,{isolated:!0});if(!o||!e.selection)return;tt(e,{anchor:o,focus:e.selection.anchor}),B.addMark(e,"italic",!1),n.deleteAt(e,o,1),t.preventDefault()}},L={isBoldActive:Je,isItalicActive:Xe,toggleBold:ko,toggleItalic:vo,setBold:et,setItalic:tt,unsetBold:_o,unsetItalic:xo,handleBoldAndItalic:To};import h,{useContext as gn}from"react";var ce={container:"Toolbar-module__container_rf3kvG__030",innerContainer:"Toolbar-module__innerContainer_rf3kvG__030"};import N,{useMemo as Po,useContext as No}from"react";var ot={button:"ToolbarButton-module__button_U5m4DG__030"};import{FaBold as Io,FaItalic as So,FaListOl as Bo,FaList as Fo,FaQuoteLeft as wo,FaCode as Lo,FaUpload as Uo,FaLink as Mo,FaImage as Ao}from"react-icons/fa";import{createContext as Ho}from"react";var a=Ho(void 0);var x=e=>{let t=No(a),o=Po(()=>{switch(e.icon){case"bold":return N.createElement(Io,null);case"italic":return N.createElement(So,null);case"ordered-list":return N.createElement(Bo,null);case"unordered-list":return N.createElement(Fo,null);case"blockquote":return N.createElement(wo,null);case"code":return N.createElement(Lo,null);case"upload":return N.createElement(Uo,null);case"hyperlink":return N.createElement(Mo,null);case"image":return N.createElement(Ao,null)}},[e.icon]);return N.createElement("button",{onMouseDown:i=>{i.preventDefault()},className:`${ot.button} ${t?.toolbar?.buttonClassName||""} ${e.active?"active":""}`,onClick:e.onClick},o||e.text)};import{Editor as qo}from"slate";var A=(e,t)=>{let[o]=qo.nodes(e,{match:r=>r.type===t});return!!o},$o=(e,t)=>{A(e,t)?n.changeCurrentNodeType(e,"paragraph"):n.changeCurrentNodeType(e,t)},Oo=(e,t)=>{if(!A(e,t))return n.liftToRoot(e),n.changeCurrentNodeType(e,t);n.changeCurrentNodeType(e,"paragraph")},Vo=(e,t,o,r)=>{if(A(e,t))n.removeInlineNode(e);else{let d=r&&n.isCursor(e)?{...o,children:r}:o;n.changeCurrentNodeType(e,t,d)}},Do=(e,t)=>{let o=A(e,t),r=n.isChildOf(e,"ordered-list-item"),i=n.isChildOf(e,"unordered-list-item"),d=r||i;if(o&&d)return n.unwrapLeaf(e);if(o&&!d)return n.changeCurrentNodeType(e,"paragraph");n.changeCurrentNodeType(e,t),d&&n.wrapNode(e,r?"ordered-list-item":"unordered-list-item")},pe=(e,t)=>{t.shiftKey?n.createNewline(e):n.createRootParagraph(e),t.preventDefault()},Ko=(e,t)=>{let o=n.isChildOf(e,"ordered-list-item"),r=n.isChildOf(e,"unordered-list-item"),i=o||r;if(!i||t.shiftKey)return pe(e,t);if(i)return n.createNewNodeOfCurrentType(e),n.changeCurrentNodeType(e,o?"ordered-list-item":"unordered-list-item"),t.preventDefault();pe(e,t)},rt=(e,t)=>{do n.unwrapNode(e);while(n.parentBlockType(e)===t);n.changeCurrentNodeType(e,"paragraph")},Go=(e,t,o)=>{let r=t==="ordered-list"?"ordered-list-item":"unordered-list-item";if(A(e,r))return rt(e,t);n.isChildOf(e,t)||n.wrapNode(e,t),n.changeCurrentNodeType(e,r)},Ro=(e,t,o)=>{if(o.shiftKey){n.unwrapNode(e);let r=n.parentBlock(e);(!r||r.type!==t)&&n.changeCurrentNodeType(e,"paragraph")}else{let r=n.parentBlock(e);if(!n.currentBlock(e)||!r)return;n.wrapNode(e,t)}o.preventDefault()},Wo=(e,t,o)=>{n.textSinceBlockStart(e)===""&&(rt(e,t),o.preventDefault())},l={defaultIsActive:A,defaultToggle:$o,toggleInlineNode:Vo,toggleAtRoot:Oo,toggleWithListAllowed:Do,onEnterWithShiftLinebreak:pe,onEnterWithListAndNewlineAllowed:Ko,toggleListItem:Go,onTabListItem:Ro,onEnterListItem:Wo};var zo=e=>l.defaultIsActive(e,"unordered-list"),Zo=e=>{l.defaultToggle(e,"unordered-list")},R={elementType:"unordered-list",isVoid:!1,isInline:!1,active:zo,toggle:Zo};var jo=e=>l.defaultIsActive(e,"ordered-list"),Qo=e=>{l.defaultToggle(e,"ordered-list")},W={elementType:"ordered-list",isVoid:!1,isInline:!1,active:jo,toggle:Qo};var Yo=e=>l.defaultIsActive(e,"blockquote"),Jo=e=>{l.toggleWithListAllowed(e,"blockquote")},Xo=(e,t)=>{l.onEnterWithListAndNewlineAllowed(e,t)},O={elementType:"blockquote",shortcutText:">",isVoid:!1,isInline:!1,active:Yo,toggle:Jo,onEnter:Xo};var er=e=>l.defaultIsActive(e,"code"),tr=e=>{l.toggleWithListAllowed(e,"code")},or=(e,t)=>{l.onEnterWithListAndNewlineAllowed(e,t)},V={elementType:"code",shortcutText:"```",isVoid:!1,isInline:!1,active:er,toggle:tr,onEnter:or};var rr=e=>l.defaultIsActive(e,"heading-1"),nr=e=>{l.toggleAtRoot(e,"heading-1")},lr=(e,t)=>{n.createRootParagraph(e),t.preventDefault()},z={elementType:"heading-1",shortcutText:"#",isVoid:!1,isInline:!1,active:rr,toggle:nr,onEnter:lr};var ir=e=>l.defaultIsActive(e,"heading-2"),sr=e=>{l.toggleAtRoot(e,"heading-2")},ar=(e,t)=>{n.createRootParagraph(e),t.preventDefault()},Z={elementType:"heading-2",shortcutText:"##",isVoid:!1,isInline:!1,active:ir,toggle:sr,onEnter:ar};var mr=e=>l.defaultIsActive(e,"heading-3"),ur=e=>{l.toggleAtRoot(e,"heading-3")},dr=(e,t)=>{n.createRootParagraph(e),t.preventDefault()},j={elementType:"heading-3",shortcutText:"###",isVoid:!1,isInline:!1,active:mr,toggle:ur,onEnter:dr};var cr=e=>l.defaultIsActive(e,"heading-4"),pr=e=>{l.toggleAtRoot(e,"heading-4")},fr=(e,t)=>{n.createRootParagraph(e),t.preventDefault()},Q={elementType:"heading-4",shortcutText:"####",isVoid:!1,isInline:!1,active:cr,toggle:pr,onEnter:fr};var Cr=e=>l.defaultIsActive(e,"heading-5"),gr=e=>{l.toggleAtRoot(e,"heading-5")},Er=(e,t)=>{n.createRootParagraph(e),t.preventDefault()},Y={elementType:"heading-5",shortcutText:"#####",isVoid:!1,isInline:!1,active:Cr,toggle:gr,onEnter:Er};var hr=e=>l.defaultIsActive(e,"heading-6"),br=e=>{l.toggleAtRoot(e,"heading-6")},yr=(e,t)=>{n.createRootParagraph(e),t.preventDefault()},J={elementType:"heading-6",shortcutText:"######",isVoid:!1,isInline:!1,active:hr,toggle:br,onEnter:yr};var _r=e=>l.defaultIsActive(e,"unordered-list-item"),xr=(e,t)=>{l.toggleListItem(e,"unordered-list",t)},kr=(e,t)=>{l.onTabListItem(e,"unordered-list",t)},vr=(e,t)=>{l.onEnterListItem(e,"unordered-list",t)},X={elementType:"unordered-list-item",shortcutText:"*",isVoid:!1,isInline:!1,active:_r,toggle:xr,onTab:kr,onEnter:vr};var Tr=e=>l.defaultIsActive(e,"paragraph"),Hr=e=>{n.changeCurrentNodeType(e,"paragraph")},Pr=(e,t)=>{l.onEnterWithShiftLinebreak(e,t)},nt={elementType:"paragraph",isVoid:!1,isInline:!1,active:Tr,toggle:Hr,onEnter:Pr};var Nr=e=>l.defaultIsActive(e,"hyperlink"),Ir=(e,t,o)=>{if(t?.actor=="shortcut"&&t.actorShortcutMatch){if(t.actorShortcutMatch.length<3)return;let r=t.actorShortcutMatch[1],i=t.actorShortcutMatch[2];n.createNewNode(e,"hyperlink",{children:[{text:r}],props:{href:i},createFollowingText:" "})}else l.toggleInlineNode(e,"hyperlink",o,[{text:"Link"}])},Sr=(e,t)=>{if(!n.isChildOf(e,"hyperlink"))return n.isSelection(e)?n.wrapNode(e,"hyperlink",t):n.createNewNode(e,"hyperlink",{children:t.children,props:t,voids:!0,createFollowingText:" "});n.changeNearestNodeProps(e,"hyperlink",t)},H={elementType:"hyperlink",shortcutRegex:/\[(.+)]\((.+)\)$/,isVoid:!1,isInline:!0,active:Nr,toggle:Ir,onUpsert:Sr};var Br=e=>l.defaultIsActive(e,"image"),Fr=(e,t,o)=>{if(t?.actor=="shortcut"&&t.actorShortcutMatch){if(t.actorShortcutMatch.length<3)return;let r=t.actorShortcutMatch[1],i=t.actorShortcutMatch[2];n.createNewNode(e,"image",{props:{src:i,altText:r},createFollowingText:" "})}else l.toggleInlineNode(e,"image",o)},wr=(e,t)=>{let o=n.currentElement(e);o&&(o.type==="image"?n.changeNearestNodeProps(e,"image",t):n.createNewNode(e,"image",{props:t,voids:!0,createFollowingText:" "}))},F={elementType:"image",shortcutRegex:/!\[(.+)]\((.+)\)$/,isVoid:!0,isInline:!0,active:Br,toggle:Fr,onUpsert:wr};var Lr=e=>l.defaultIsActive(e,"ordered-list-item"),Ur=(e,t)=>{l.toggleListItem(e,"ordered-list",t)},Mr=(e,t)=>{l.onTabListItem(e,"ordered-list",t)},Ar=(e,t)=>{l.onEnterListItem(e,"ordered-list",t)},ee={elementType:"ordered-list-item",shortcutRegex:/^\d+\.$/,isVoid:!1,isInline:!1,active:Lr,toggle:Ur,onTab:Mr,onEnter:Ar};var te=[O,V,z,Z,j,Q,Y,J,F,H,W,ee,nt,R,X],q={};te.forEach(e=>{q[e.elementType]=e});var fe=te.filter(e=>!e.isInline),qr={};fe.forEach(e=>{qr[e.elementType]=e});var oe=te.filter(e=>e.isInline),$r={};oe.forEach(e=>{$r[e.elementType]=e});var Ce=te.filter(e=>e.isVoid),Or={};Ce.forEach(e=>{Or[e.elementType]=e});import lt from"react";var ge={container:"ToolbarButtonSpacer-module__container_kEBEkG__030",spacer:"ToolbarButtonSpacer-module__spacer_kEBEkG__030"};var D=()=>lt.createElement("div",{className:ge.container},lt.createElement("div",{className:ge.spacer}));import{useSlate as En}from"slate-react";import I,{useContext as nn,useEffect as ln,useMemo as sn,useRef as an,useState as bt}from"react";import it,{useRef as Vr,useContext as Dr}from"react";var Ee={container:"Popover-module__container_dxsL9W__030",innerContainer:"Popover-module__innerContainer_dxsL9W__030"};import{useOnClickOutside as Kr}from"usehooks-ts";var re=e=>{let t=Dr(a),o=Vr(null);Kr(o,e.onClose);let r=i=>{e.onPressEnter&&i.key==="Enter"&&e.onPressEnter()};return it.createElement("div",{className:`${Ee.container} ${t?.popover?.containerClassName||""}`},it.createElement("div",{className:`${Ee.innerContainer} ${e.align} ${t?.popover?.innerContainerClassName||""}`,ref:o,onKeyDown:r},e.children))};var he={container:"HyperlinkToolbarButton-module__container_KZEcDq__030",hrefInput:"HyperlinkToolbarButton-module__hrefInput_KZEcDq__030"};import{ReactEditor as mn,useSlate as un}from"slate-react";import on,{useContext as rn}from"react";var st={container:"Form-module__container_R0Llbq__030"};import Gr,{useContext as Rr}from"react";var at={container:"FormGroup-module__container_t4ESPW__030"};var ne=e=>{let t=Rr(a);return Gr.createElement("div",{className:`${at.container} ${t?.forms?.groupClassName||""}`},e.children)};import Wr,{useContext as zr}from"react";var mt={label:"FormLabel-module__label_jkwkqq__030"};var ut=e=>{let t=zr(a);return Wr.createElement("label",{className:`${mt.label} ${t?.forms?.labelClassName}`},e.text)};import Zr,{useContext as jr}from"react";var dt={input:"FormInput-module__input_x5oyYq__030"};var ct=e=>{let t=jr(a),o=r=>{e.onChange(r.target.value)};return Zr.createElement("input",{ref:e.ref,className:`${dt.input} ${e.className||void 0} ${t?.forms?.inputClassName||""}`,value:e.value,onChange:o})};import Qr,{useContext as Yr}from"react";var pt={error:"FormError-module__error_TZXMUq__030"};var ft=e=>{let t=Yr(a);return Qr.createElement("span",{className:`${pt.error} ${t?.forms?.errorClassName||""}`},e.text)};import Jr,{useContext as Xr}from"react";var Ct={container:"FormButtonGroup-module__container_4Hygba__030"};var gt=e=>{let t=Xr(a);return Jr.createElement("div",{className:`${Ct.container} ${t?.forms?.buttonsContainerClassName||""}`},e.children)};import en,{useContext as tn}from"react";var Et={button:"FormButton-module__button_C8cIaW__030"};var ht=e=>{let t=tn(a),o=r=>{r.preventDefault()};return en.createElement("button",{className:`${Et.button} ${t?.forms?.buttonClassName} ${e.type}`,onClick:e.onClick,onMouseDown:o},e.children)};var m=e=>{let t=rn(a);return on.createElement("form",{className:`${st.container} ${t?.forms?.containerClassName||""}`},e.children)};m.Group=ne;m.Label=ut;m.Input=ct;m.Error=ft;m.ButtonGroup=gt;m.Button=ht;var yt=()=>{let e=nn(a),t=un(),[o,r]=bt(!1),[i,d]=bt(""),k=an(null);ln(()=>{if(!o)return;k.current?.focus();let b=n.nearestElementOfType(t,"hyperlink");if(!b||!b.href)return d("https://niiice.io");d(b.href)},[o,t]);let v=()=>{r(!1),mn.focus(t)},T=()=>{r(!o)},P=()=>{H.onUpsert&&(H.onUpsert(t,{href:i,children:[{text:i}]}),v())},g=sn(()=>n.isChildOf(t,"hyperlink"),[t.selection]),c=()=>{H.toggle(t),v()},f=()=>{P()};return I.createElement("div",{className:he.container},I.createElement(x,{onClick:T,icon:"hyperlink"}),o&&I.createElement(re,{onClose:v,onPressEnter:f,align:"top-right"},I.createElement(m,null,I.createElement(m.Group,null,I.createElement(m.Label,{text:e?.texts?.url||"Url"}),I.createElement(m.Input,{ref:k,value:i,onChange:d,className:he.hrefInput})),I.createElement(m.ButtonGroup,null,g&&I.createElement(m.Button,{type:"danger",onClick:c},e?.texts?.remove||"Remove"),I.createElement(m.Button,{type:"primary",onClick:P},e?.texts?.insert||"Insert")))))};import{ReactEditor as dn,useSlate as cn}from"slate-react";import S,{useContext as pn,useEffect as fn,useRef as Cn,useState as _t}from"react";var be={container:"ImageToolbarButton-module__container_N6H06G__030",srcInput:"ImageToolbarButton-module__srcInput_N6H06G__030"};var xt=e=>{let t=pn(a),o=cn(),[r,i]=_t(!1),[d,k]=_t(""),v=Cn(null);fn(()=>{if(!r)return;v.current?.focus();let b=n.nearestElementOfType(o,"image");if(!b||!b.src)return k("https://niiice.io/wp-content/uploads/2020/04/niiice-Logo_dark.png");k(b.src)},[r,o]);let T=()=>{i(!1),dn.focus(o)},P=()=>{i(!r)},g=()=>{F.onUpsert&&(F.onUpsert(o,{src:d}),T())},c=()=>{g()},f=()=>{e.onUploadRequest&&(T(),e.onUploadRequest("image/*"))};return S.createElement("div",{className:be.container},S.createElement(x,{onClick:P,icon:"image"}),r&&S.createElement(re,{onClose:T,onPressEnter:c,align:"top-right"},S.createElement(m,null,S.createElement(m.Group,null,S.createElement(m.Label,{text:t?.texts?.url||"Url"}),S.createElement(m.Input,{ref:v,value:d,onChange:k,className:be.srcInput})),S.createElement(m.ButtonGroup,null,e.onUploadRequest&&S.createElement(m.Button,{type:"secondary",onClick:f},t?.texts?.upload||"Upload"),S.createElement(m.Button,{type:"primary",onClick:g},t?.texts?.insert||"Insert")))))};var kt=e=>{let t=En(),o=gn(a),r=()=>{L.toggleBold(t)},i=()=>{L.toggleItalic(t)},d=f=>{q[`heading-${f}`].toggle(t,{actor:"toolbar"})},k=()=>{X.toggle(t,{actor:"toolbar"})},v=()=>{ee.toggle(t,{actor:"toolbar"})},T=()=>{O.toggle(t,{actor:"toolbar"})},P=()=>{V.toggle(t,{actor:"toolbar"})},g=()=>{e.onUploadRequest&&e.onUploadRequest(void 0,!0)},c={bold:L.isBoldActive(t),italic:L.isItalicActive(t),"heading-1":z.active(t),"heading-2":Z.active(t),"heading-3":j.active(t),"heading-4":Q.active(t),"heading-5":Y.active(t),"heading-6":J.active(t),"unordered-list":R.active(t),"ordered-list":W.active(t),blockquote:O.active(t),code:V.active(t),hyperlink:H.active(t)};return h.createElement("div",{className:`${ce.container} ${o?.toolbar?.containerClassName||""}`},h.createElement("div",{className:ce.innerContainer},h.createElement(x,{icon:"bold",onClick:r,active:c.bold}),h.createElement(x,{icon:"italic",onClick:i,active:c.italic}),h.createElement(D,null),[1,2,3,4,5,6].map(f=>h.createElement(x,{key:f,onClick:()=>d(f),text:`H${f}`,active:c[`heading-${f}`]})),h.createElement(D,null),h.createElement(x,{icon:"unordered-list",onClick:k,active:c["unordered-list"]}),h.createElement(x,{icon:"ordered-list",onClick:v,active:c["ordered-list"]}),h.createElement(D,null),h.createElement(x,{icon:"blockquote",onClick:T,active:c.blockquote}),h.createElement(x,{icon:"code",onClick:P,active:c.code}),h.createElement(D,null),h.createElement(yt,null),h.createElement(xt,{onUploadRequest:e.onUploadRequest}),e.onUploadRequest&&h.createElement(x,{icon:"upload",onClick:g,active:!1})))};var ye={container:"MarkdownEditor-module__container_mfJZzW__030",editor:"MarkdownEditor-module__editor_mfJZzW__030"};var le={container:"elements-module__container_bH2TYq__030"};import $,{useContext as xn,useEffect as kn,useState as Tt}from"react";var _e={fileInput:"UploadModal-module__fileInput_uGKa2W__030",progressBar:"UploadModal-module__progressBar_uGKa2W__030"};import M,{useContext as hn,useRef as bn}from"react";import{IoCloseOutline as yn}from"react-icons/io5";var U={bodyContainer:"Modal-module__bodyContainer_QZ8FHq__030",closeButton:"Modal-module__closeButton_QZ8FHq__030",container:"Modal-module__container_QZ8FHq__030",header:"Modal-module__header_QZ8FHq__030",headerContainer:"Modal-module__headerContainer_QZ8FHq__030",innerContainer:"Modal-module__innerContainer_QZ8FHq__030"};import{useOnClickOutside as _n}from"usehooks-ts";var vt=e=>{let t=hn(a),o=bn(null);return _n(o,e.onClose),M.createElement("div",{className:`${U.container} ${t?.modal?.containerClassName||""}`},M.createElement("div",{className:`${U.innerContainer} ${t?.modal?.innerContainerClassName||""}`,ref:o},M.createElement("div",{className:`${U.headerContainer} ${t?.modal?.headerContainerClassName||""}`},M.createElement("span",{className:U.header},e.title),M.createElement("button",{className:U.closeButton,onClick:e.onClose},M.createElement(yn,{size:"1.5rem"}))),M.createElement("div",{className:`${U.bodyContainer} ${t?.modal?.bodyContainerClassName||""}`},e.children)))};var Ht=e=>{let t=xn(a),[o,r]=Tt(null),[i,d]=Tt(null),k=g=>{r(g.message)},v=g=>{d(g)},T=(g,c,f)=>{e.onUploadFinish(g,c,f)};kn(()=>{e.uploader.setOnProgressViewCallback(v),e.uploader.setOnErrorViewCallback(k),e.uploader.setOnFinishViewCallback(T)},[e.uploader]);let P=g=>{r(null);let c=g.currentTarget.files;if(!c)return;let f=Array.from(c);if(e.acceptedFileTypes){for(let b of f)if(!vn(b.type,e.acceptedFileTypes))return r(t?.texts?.invalidFileTypeError||"Invalid file type.")}if(e.maxFileSize){for(let b of f)if(b.size>e.maxFileSize)return r(t?.texts?.maxFileSizeError||"File too large.")}d(0);for(let b of f)e.uploader.startUpload(b).then()};return $.createElement(vt,{title:t?.texts?.uploadModalHeaderTitle||"Upload file",onClose:e.onClose},$.createElement(m,null,$.createElement(ne,null,$.createElement("input",{className:_e.fileInput,type:"file",onChange:P,disabled:i!==null}),o&&$.createElement(m.Error,{text:o}))),i!==null&&$.createElement("progress",{className:_e.progressBar,max:100,value:i*100}))},vn=(e,t)=>(t=t.replace(/\s/g,""),t.split(",").some(r=>{if(r.endsWith("/*")){let i=r.split("/")[0];return e.startsWith(i)}else return r===e}));import Pt from"react";var Nt=e=>Pt.createElement("span",{contentEditable:!1,...e.attributes},Pt.createElement("img",{src:e.element.src,alt:e.element.altText||"Image"}),e.children);import Tn from"react";var It=e=>Tn.createElement("a",{href:e.element.href,...e.attributes},e.children);import Hn from"react";var St=e=>Hn.createElement(a.Provider,{value:e.value},e.children);import Pn from"react";var Bt=e=>Pn.createElement("li",{...e.attributes},e.children);var Un=e=>{let[t]=wt(()=>An(Mn(wn(Sn())))),[o,r]=wt({show:!1}),i=Nn([]),d=Ft(s=>{switch(s.element.type){case"blockquote":return u.createElement(Pe,{...s});case"code":return u.createElement(Te,{...s});case"heading-1":return u.createElement(Ne,{...s});case"heading-2":return u.createElement(Ie,{...s});case"heading-3":return u.createElement(Se,{...s});case"heading-4":return u.createElement(Be,{...s});case"heading-5":return u.createElement(Fe,{...s});case"heading-6":return u.createElement(we,{...s});case"image":return u.createElement(Nt,{...s});case"hyperlink":return u.createElement(It,{...s});case"ordered-list-item":return u.createElement(Bt,{...s});case"ordered-list":return u.createElement(Le,{...s});case"unordered-list":return u.createElement(Ue,{...s});case"unordered-list-item":return u.createElement(Me,{...s});default:return u.createElement(He,{...s})}},[]),k=Ft(s=>u.createElement(Ye,{...s}),[]),v=s=>{switch(s.key){case"_":case"*":{L.handleBoldAndItalic(t,s);break}case" ":case"Dead":{let p=n.textSinceBlockStart(t);if(!p)break;let _=!1;for(let w of fe)if(p===w.shortcutText||w.shortcutRegex?.test(p)){n.deleteFromLeft(t,p.length),w.toggle(t,{actor:"shortcut",actorShortcut:p}),s.preventDefault(),_=!0;break}if(_||!t.selection)return;for(let w of oe){if(!w.shortcutRegex)continue;let K=p.match(w.shortcutRegex);if(K){n.deleteAt(t,{path:t.selection.anchor.path,offset:p.length-K[0].length},K[0].length),w.toggle(t,{actor:"shortcut",actorShortcutMatch:K}),s.preventDefault();break}}break}case"Tab":{let p=n.currentBlockType(t);if(!p)break;let _=q[p].onTab;if(!_)break;_(t,s);break}case"Enter":{let p=n.currentElementType(t);if(!p)break;let _=q[p].onEnter;if(!_)break;_(t,s);break}}},T=s=>{if(t.operations.some(_=>_.type!=="set_selection")){if(i.current=s,!e.onChange)return;e.onChange(s)}},P=s=>{e.onBlur&&(e.onBlur(s,i.current),s.preventDefault())},g=(s,p)=>{r({show:!0,accept:s,forceAttachment:p})},c=()=>{r({show:!1}),Ln.focus(t)},f=(s,p,_)=>{if(p.type.includes("image")&&!o.forceAttachment){if(!F.onUpsert)return;F.onUpsert(t,{src:s,metaData:_})}else{if(!H.onUpsert)return;H.onUpsert(t,{children:[{text:p.name}],href:s,metaData:_})}c()},b=In(()=>e.initialValue&&e.initialValue.length>0?e.initialValue:[{type:"paragraph",children:[{text:e.defaultText!==void 0?e.defaultText:""}]}],[e.initialValue,e.defaultText]);return u.createElement(St,{value:e.customStyle},u.createElement(Bn,{editor:t,initialValue:b,onChange:T},u.createElement("div",{className:`${ye.container} ${e.customStyle?.editor?.containerClassName||""}`},u.createElement(kt,{onUploadRequest:e.uploadInfo?g:void 0}),u.createElement(Fn,{className:`${ye.editor} ${le.container} ${e.customStyle?.editor?.editorContainerClassName||""}`,renderElement:d,renderLeaf:k,onKeyDown:v,onBlur:P})),e.uploadInfo&&o.show&&u.createElement(Ht,{onUploadFinish:f,onClose:c,...e.uploadInfo,acceptedFileTypes:o.accept||e.uploadInfo.acceptedFileTypes})))},Mn=e=>{let{isInline:t}=e;return e.isInline=o=>oe.map(i=>i.elementType).includes(o.type)||t(o),e},An=e=>{let{isVoid:t}=e;return e.isVoid=o=>Ce.map(i=>i.elementType).includes(o.type)||t(o),e};import Mt,{useMemo as Dn}from"react";var Lt=(e,t)=>e.filter(o=>o===t).length,Ut=e=>Array(e*4).join(" "),qn={blockquote:(e,t)=>`> ${y(e.children,[...t,"blockquote"])}
`,code:(e,t)=>`\`\`\`
${y(e.children,[...t,"code"])}
\`\`\`
`,"heading-1":(e,t)=>`# ${y(e.children,[...t,"heading-1"])}
`,"heading-2":(e,t)=>`## ${y(e.children,[...t,"heading-2"])}
`,"heading-3":(e,t)=>`### ${y(e.children,[...t,"heading-3"])}
`,"heading-4":(e,t)=>`#### ${y(e.children,[...t,"heading-4"])}
`,"heading-5":(e,t)=>`##### ${y(e.children,[...t,"heading-5"])}
`,"heading-6":(e,t)=>`###### ${y(e.children,[...t,"heading-6"])}
`,hyperlink:(e,t)=>`[${y(e.children,[...t,"hyperlink"])}](${e.href||""})`,image:(e,t)=>`![${e.altText||""}](${e.src||""})`,"ordered-list":(e,t)=>y(e.children,[...t,"ordered-list"]),"ordered-list-item":(e,t)=>{let o=Lt(t,"ordered-list"),r=Ut(o-1);return r=`${r}1. ${y(e.children,[...t,"ordered-list-item"])}
`,r},paragraph:(e,t)=>`
${y(e.children,[...t,"paragraph"])}
`,"unordered-list":(e,t)=>y(e.children,[...t,"unordered-list"]),"unordered-list-item":(e,t)=>{let o=Lt(t,"unordered-list"),r=Ut(o-1);return r=`${r}* ${y(e.children,[...t,"unordered-list-item"])}
`,r}},$n=e=>{if(!e.text)return"";let t=e.text;return e.bold&&(t=`**${t}**`),e.italic&&(t=`*${t}*`),t},On=(e,t)=>{let o=qn[e.type];return o?o(e,t):""},Vn=(e,t)=>{if(n.isLeaf(e))return $n(e);let o=e;return o.type?On(o,t):""},y=(e,t,o="")=>e?e?.map(r=>Vn(r,t)).join(o):"",xe=e=>y(e,[]);import Kn from"react-markdown";import Gn from"remark-gfm";import Rn from"remark-breaks";var Wn=e=>{let t=Dn(()=>typeof e.value=="string"?e.value:xe(e.value),[e.value]);return Mt.createElement("div",{className:`${le.container} ${e.className||""}`},Mt.createElement(Kn,{remarkPlugins:[Gn,Rn]},t))};var ke=class{onProgress(t){this.onProgressViewCallback&&this.onProgressViewCallback(t)}onFinish(t,o,r={}){this.onFinishViewCallback&&this.onFinishViewCallback(t,o,r)}onError(t){this.onErrorViewCallback&&this.onErrorViewCallback(t)}setOnProgressViewCallback(t){this.onProgressViewCallback=t}setOnFinishViewCallback(t){this.onFinishViewCallback=t}setOnErrorViewCallback(t){this.onErrorViewCallback=t}};export{ke as AbstractUploader,Un as MarkdownEditor,Wn as MarkdownView,xe as toMarkdown};
//# sourceMappingURL=index.js.map
