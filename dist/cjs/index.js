"use strict";var Eo=Object.create;var Z=Object.defineProperty;var ho=Object.getOwnPropertyDescriptor;var bo=Object.getOwnPropertyNames;var yo=Object.getPrototypeOf,_o=Object.prototype.hasOwnProperty;var xo=(e,t)=>{for(var o in t)Z(e,o,{get:t[o],enumerable:!0})},Oe=(e,t,o,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of bo(t))!_o.call(e,i)&&i!==o&&Z(e,i,{get:()=>t[i],enumerable:!(r=ho(t,i))||r.enumerable});return e};var a=(e,t,o)=>(o=e!=null?Eo(yo(e)):{},Oe(t||!e||!e.__esModule?Z(o,"default",{value:e,enumerable:!0}):o,e)),ko=e=>Oe(Z({},"__esModule",{value:!0}),e);var mn={};xo(mn,{AbstractUploader:()=>_e,MarkdownEditor:()=>mo,MarkdownView:()=>go,toMarkdown:()=>ye});module.exports=ko(mn);var u=a(require("react")),ao=require("slate"),M=require("slate-react");var xe=a(require("react")),Ve=e=>xe.default.createElement("pre",{...e.attributes},xe.default.createElement("code",null,e.children));var De=a(require("react")),Ke=e=>De.default.createElement("p",{...e.attributes},e.children);var Ge=a(require("react")),Re=e=>Ge.default.createElement("blockquote",{...e.attributes},e.children);var We=a(require("react")),ze=e=>We.default.createElement("h1",{...e.attributes},e.children);var Ze=a(require("react")),je=e=>Ze.default.createElement("h2",{...e.attributes},e.children);var Qe=a(require("react")),Ye=e=>Qe.default.createElement("h3",{...e.attributes},e.children);var Je=a(require("react")),Xe=e=>Je.default.createElement("h4",{...e.attributes},e.children);var et=a(require("react")),tt=e=>et.default.createElement("h5",{...e.attributes},e.children);var ot=a(require("react")),rt=e=>ot.default.createElement("h6",{...e.attributes},e.children);var nt=a(require("react")),lt=e=>nt.default.createElement("ol",{...e.attributes},e.children);var it=a(require("react")),st=e=>it.default.createElement("ul",{...e.attributes},e.children);var at=a(require("react")),mt=e=>at.default.createElement("li",{...e.attributes},e.children);var s=require("slate"),ut=(e,t,o)=>{s.Transforms.setNodes(e,{...o,type:t})},vo=e=>{let t=ke(e);t&&s.Transforms.unwrapNodes(e,{at:t})},ke=e=>e.selection?e.selection.anchor.path.slice(0,-1):null,dt=e=>{let t=e.selection?.anchor.path;return t?(t=t.slice(0,-1),s.Node.get(e,t)):null},To=e=>{if(!e.selection)return null;let t=dt(e);return t?t.type:null},Ho=(e,t)=>{let o=e.selection?.anchor.path;if(!o)return null;do{let r=s.Node.get(e,o);if(!r)return null;if(r.type===t)return r;o=o?.slice(0,-1)}while(o.length>0);return null},ct=e=>{s.Transforms.splitNodes(e,{always:!0})},Po=(e,t,o={})=>{if(s.Transforms.insertNodes(e,{...o.props,type:t,children:o.children||[{text:""}]},{voids:o.voids}),o.createFollowingParagraph&&s.Transforms.insertNodes(e,{type:"paragraph",children:[{text:""}]}),o.createFollowingText!==void 0){if(!e.selection)return;let r=s.Editor.parent(e,e.selection)[1];r[r.length-1]++,s.Transforms.insertNodes(e,{text:o.createFollowingText},{at:r}),s.Transforms.select(e,{anchor:{path:r,offset:o.createFollowingText.length},focus:{path:r,offset:o.createFollowingText.length}})}},No=(e,t,o={})=>{s.Transforms.wrapNodes(e,{type:t,...o},{split:!0})},Io=e=>{s.Transforms.liftNodes(e)},So=e=>{s.Transforms.unwrapNodes(e)},ve=e=>e.selection?s.Point.equals(e.selection.anchor,e.selection.focus):!1,pt=e=>e.selection?!ve(e):!1,Te=e=>{let t=s.Editor.above(e,{match:r=>s.Editor.isBlock(e,r)}),o=t?t[1]:[];return s.Editor.start(e,o)},ft=e=>{let t=s.Editor.above(e,{match:r=>s.Editor.isBlock(e,r)}),o=t?t[1]:[];return s.Editor.end(e,o)},Ct=e=>{if(!e.selection)return null;let t=Te(e),o={anchor:e.selection.anchor,focus:t};return s.Editor.string(e,o)},Bo=e=>{if(!e.selection)return null;let t=ft(e),o={anchor:e.selection.focus,focus:t};return s.Editor.string(e,o)},Fo=(e,t,o)=>{if(!e.selection)return null;let r=He(e);if(!r)return null;let i=r.lastIndexOf(t);return o?.isolated&&(r.substring(i+t.length,i+t.length*2)===t||r.substring(i-t.length,i)===t)||i===-1?null:{path:e.selection.anchor.path,offset:i}},wo=(e,t)=>!e.selection||!ve(e)?!1:!!Ct(e)?.endsWith(t),He=e=>e.selection?s.Editor.string(e,{anchor:{path:e.selection.anchor.path,offset:0},focus:e.selection.anchor}):null,gt=(e,t)=>{if(!e.selection)return;let o=Te(e);o&&(s.Transforms.delete(e,{at:{anchor:o,focus:e.selection.anchor}}),s.Transforms.insertText(e,t,{at:o}))},Lo=(e,t)=>{let o=He(e);o&&(o=o.slice(t),gt(e,o))},Uo=(e,t)=>{for(let o=0;o<t;o++)s.Editor.deleteBackward(e,{unit:"character"})},Mo=(e,t,o)=>{s.Transforms.delete(e,{at:t,distance:o,unit:"character"})},Et=(e,t)=>e.selection?s.Editor.above(e,{match:o=>t.includes(o.type)})!==void 0:!1,Ao=(e,t)=>e.selection?Et(e,[t]):!1,ht=e=>{if(!e.selection)return null;let t=s.Editor.above(e,{match:o=>s.Editor.isBlock(e,o)});return!t||!_t(t[0])?null:t[0]},qo=e=>{if(!e.selection)return null;let t=ke(e);return t?Pe(e,t):null},Pe=(e,t)=>{let o=t;if(o.length===0)return null;do{let r=s.Node.get(e,o);if(!r)return null;if(s.Editor.isBlock(e,r))return o;o=o.slice(0,-1)}while(o.length>0);return null},$o=e=>{if(!e.selection)return null;let t=ht(e);return t?t.type:null},bt=e=>{if(!e.selection)return null;let t=qo(e);return!t||(t=t.slice(0,-1),t=Pe(e,t),!t)?null:s.Node.get(e,t)},Oo=e=>{let t=bt(e);return t?t.type:null},yt=e=>{if(!e.selection)return null;let t=s.Editor.node(e,e.selection.anchor);return!t||!xt(t[0])?null:t[0]},_t=e=>{let t=e;return!!(t&&t.type)},xt=e=>{let t=e;return!!(t&&t.text)},Vo=e=>{let t=e.selection?.anchor||e.selection?.focus;return t?t.path.length<=2:!1},Do=e=>{let t=e,o=e;return!t.text&&!o.type},Ko=e=>{if(pt(e)||!e.selection)return!1;let t=yt(e);return t?t.text==="":!0},Go=e=>{e.selection&&(ct(e),ut(e,"paragraph"),kt(e))},Ro=e=>{s.Transforms.insertText(e,`
`)},kt=e=>{for(;!n.isAtRoot(e);)s.Transforms.liftNodes(e)},Wo=(e,t,o)=>{e.selection&&s.Transforms.setNodes(e,t,{at:o||e.selection,match:r=>s.Text.isText(r),split:!0})},zo=(e,t,o)=>{s.Transforms.setNodes(e,o,{match:r=>r.type===t})},n={removeInlineNode:vo,changeCurrentNodeType:ut,createNewNode:Po,createNewNodeOfCurrentType:ct,wrapNode:No,unwrapNode:Io,unwrapLeaf:So,isCursor:ve,isSelection:pt,nearestBlockPath:Pe,currentBlockStart:Te,currentBlockEnd:ft,textSinceBlockStart:Ct,textToBlockEnd:Bo,lastPosOf:Fo,cursorIsBehind:wo,currentBlockText:He,setCurrentBlockText:gt,deleteFromLeft:Lo,deleteFromRight:Uo,deleteAt:Mo,isChildOf:Ao,isChildOfAny:Et,nearestElementOfType:Ho,currentBlock:ht,currentBlockType:$o,currentElement:dt,currentElementType:To,currentElementPath:ke,parentBlock:bt,parentBlockType:Oo,currentLeaf:yt,isElement:_t,isLeaf:xt,isRoot:Do,isEmpty:Ko,isAtRoot:Vo,createRootParagraph:Go,createNewline:Ro,liftToRoot:kt,setLeafFormat:Wo,changeNearestNodeProps:zo};var j=a(require("react")),vt=e=>{let t=j.default.createElement("span",{...e.attributes},e.children);return e.leaf.bold&&(t=j.default.createElement("strong",null,t)),e.leaf.italic&&(t=j.default.createElement("em",null,t)),t};var L=require("slate");var Tt=e=>!!L.Editor.marks(e)?.bold,Ht=e=>!!L.Editor.marks(e)?.italic,Pt=(e,t)=>{e.selection&&n.setLeafFormat(e,{bold:!0},t)},Zo=e=>{n.setLeafFormat(e,{bold:void 0})},Nt=(e,t)=>{e.selection&&n.setLeafFormat(e,{italic:!0},t)},jo=e=>{n.setLeafFormat(e,{italic:void 0})},Qo=e=>{Tt(e)?L.Editor.removeMark(e,"bold"):L.Editor.addMark(e,"bold",!0)},Yo=e=>{Ht(e)?L.Editor.removeMark(e,"italic"):L.Editor.addMark(e,"italic",!0)},Jo=(e,t)=>{if(["_","*"].includes(t.key))if(n.cursorIsBehind(e,t.key)){let o=n.lastPosOf(e,`${t.key}${t.key}`);if(!o||!e.selection)return;Pt(e,{anchor:o,focus:e.selection.anchor}),L.Editor.addMark(e,"bold",!1),n.deleteAt(e,o,2),n.deleteFromRight(e,1),n.deleteAt(e,e.selection.anchor,1),t.preventDefault()}else{let o=n.lastPosOf(e,t.key,{isolated:!0});if(!o||!e.selection)return;Nt(e,{anchor:o,focus:e.selection.anchor}),L.Editor.addMark(e,"italic",!1),n.deleteAt(e,o,1),t.preventDefault()}},q={isBoldActive:Tt,isItalicActive:Ht,toggleBold:Qo,toggleItalic:Yo,setBold:Pt,setItalic:Nt,unsetBold:Zo,unsetItalic:jo,handleBoldAndItalic:Jo};var h=a(require("react"));var Ne={container:"Toolbar-module__container_rf3kvG__030",innerContainer:"Toolbar-module__innerContainer_rf3kvG__030"};var k=a(require("react"));var It={button:"ToolbarButton-module__button_U5m4DG__030"};var y=require("react-icons/fa");var St=require("react"),d=(0,St.createContext)(void 0);var P=e=>{let t=(0,k.useContext)(d),o=(0,k.useMemo)(()=>{switch(e.icon){case"bold":return k.default.createElement(y.FaBold,null);case"italic":return k.default.createElement(y.FaItalic,null);case"ordered-list":return k.default.createElement(y.FaListOl,null);case"unordered-list":return k.default.createElement(y.FaList,null);case"blockquote":return k.default.createElement(y.FaQuoteLeft,null);case"code":return k.default.createElement(y.FaCode,null);case"upload":return k.default.createElement(y.FaUpload,null);case"hyperlink":return k.default.createElement(y.FaLink,null);case"image":return k.default.createElement(y.FaImage,null)}},[e.icon]);return k.default.createElement("button",{onMouseDown:i=>{i.preventDefault()},className:`${It.button} ${t?.toolbar?.buttonClassName||""} ${e.active?"active":""}`,onClick:e.onClick},o||e.text)};var Bt=require("slate");var V=(e,t)=>{let[o]=Bt.Editor.nodes(e,{match:r=>r.type===t});return!!o},Xo=(e,t)=>{V(e,t)?n.changeCurrentNodeType(e,"paragraph"):n.changeCurrentNodeType(e,t)},er=(e,t)=>{if(!V(e,t))return n.liftToRoot(e),n.changeCurrentNodeType(e,t);n.changeCurrentNodeType(e,"paragraph")},tr=(e,t,o,r)=>{if(V(e,t))n.removeInlineNode(e);else{let C=r&&n.isCursor(e)?{...o,children:r}:o;n.changeCurrentNodeType(e,t,C)}},or=(e,t)=>{let o=V(e,t),r=n.isChildOf(e,"ordered-list-item"),i=n.isChildOf(e,"unordered-list-item"),C=r||i;if(o&&C)return n.unwrapLeaf(e);if(o&&!C)return n.changeCurrentNodeType(e,"paragraph");n.changeCurrentNodeType(e,t),C&&n.wrapNode(e,r?"ordered-list-item":"unordered-list-item")},Ie=(e,t)=>{t.shiftKey?n.createNewline(e):n.createRootParagraph(e),t.preventDefault()},rr=(e,t)=>{let o=n.isChildOf(e,"ordered-list-item"),r=n.isChildOf(e,"unordered-list-item"),i=o||r;if(!i||t.shiftKey)return Ie(e,t);if(i)return n.createNewNodeOfCurrentType(e),n.changeCurrentNodeType(e,o?"ordered-list-item":"unordered-list-item"),t.preventDefault();Ie(e,t)},Ft=(e,t)=>{do n.unwrapNode(e);while(n.parentBlockType(e)===t);n.changeCurrentNodeType(e,"paragraph")},nr=(e,t,o)=>{let r=t==="ordered-list"?"ordered-list-item":"unordered-list-item";if(V(e,r))return Ft(e,t);n.isChildOf(e,t)||n.wrapNode(e,t),n.changeCurrentNodeType(e,r)},lr=(e,t,o)=>{if(o.shiftKey){n.unwrapNode(e);let r=n.parentBlock(e);(!r||r.type!==t)&&n.changeCurrentNodeType(e,"paragraph")}else{let r=n.parentBlock(e);if(!n.currentBlock(e)||!r)return;n.wrapNode(e,t)}o.preventDefault()},ir=(e,t,o)=>{n.textSinceBlockStart(e)===""&&(Ft(e,t),o.preventDefault())},l={defaultIsActive:V,defaultToggle:Xo,toggleInlineNode:tr,toggleAtRoot:er,toggleWithListAllowed:or,onEnterWithShiftLinebreak:Ie,onEnterWithListAndNewlineAllowed:rr,toggleListItem:nr,onTabListItem:lr,onEnterListItem:ir};var sr=e=>l.defaultIsActive(e,"unordered-list"),ar=e=>{l.defaultToggle(e,"unordered-list")},Q={elementType:"unordered-list",isVoid:!1,isInline:!1,active:sr,toggle:ar};var mr=e=>l.defaultIsActive(e,"ordered-list"),ur=e=>{l.defaultToggle(e,"ordered-list")},Y={elementType:"ordered-list",isVoid:!1,isInline:!1,active:mr,toggle:ur};var dr=e=>l.defaultIsActive(e,"blockquote"),cr=e=>{l.toggleWithListAllowed(e,"blockquote")},pr=(e,t)=>{l.onEnterWithListAndNewlineAllowed(e,t)},K={elementType:"blockquote",shortcutText:">",isVoid:!1,isInline:!1,active:dr,toggle:cr,onEnter:pr};var fr=e=>l.defaultIsActive(e,"code"),Cr=e=>{l.toggleWithListAllowed(e,"code")},gr=(e,t)=>{l.onEnterWithListAndNewlineAllowed(e,t)},G={elementType:"code",shortcutText:"```",isVoid:!1,isInline:!1,active:fr,toggle:Cr,onEnter:gr};var Er=e=>l.defaultIsActive(e,"heading-1"),hr=e=>{l.toggleAtRoot(e,"heading-1")},br=(e,t)=>{n.createRootParagraph(e),t.preventDefault()},J={elementType:"heading-1",shortcutText:"#",isVoid:!1,isInline:!1,active:Er,toggle:hr,onEnter:br};var yr=e=>l.defaultIsActive(e,"heading-2"),_r=e=>{l.toggleAtRoot(e,"heading-2")},xr=(e,t)=>{n.createRootParagraph(e),t.preventDefault()},X={elementType:"heading-2",shortcutText:"##",isVoid:!1,isInline:!1,active:yr,toggle:_r,onEnter:xr};var kr=e=>l.defaultIsActive(e,"heading-3"),vr=e=>{l.toggleAtRoot(e,"heading-3")},Tr=(e,t)=>{n.createRootParagraph(e),t.preventDefault()},ee={elementType:"heading-3",shortcutText:"###",isVoid:!1,isInline:!1,active:kr,toggle:vr,onEnter:Tr};var Hr=e=>l.defaultIsActive(e,"heading-4"),Pr=e=>{l.toggleAtRoot(e,"heading-4")},Nr=(e,t)=>{n.createRootParagraph(e),t.preventDefault()},te={elementType:"heading-4",shortcutText:"####",isVoid:!1,isInline:!1,active:Hr,toggle:Pr,onEnter:Nr};var Ir=e=>l.defaultIsActive(e,"heading-5"),Sr=e=>{l.toggleAtRoot(e,"heading-5")},Br=(e,t)=>{n.createRootParagraph(e),t.preventDefault()},oe={elementType:"heading-5",shortcutText:"#####",isVoid:!1,isInline:!1,active:Ir,toggle:Sr,onEnter:Br};var Fr=e=>l.defaultIsActive(e,"heading-6"),wr=e=>{l.toggleAtRoot(e,"heading-6")},Lr=(e,t)=>{n.createRootParagraph(e),t.preventDefault()},re={elementType:"heading-6",shortcutText:"######",isVoid:!1,isInline:!1,active:Fr,toggle:wr,onEnter:Lr};var Ur=e=>l.defaultIsActive(e,"unordered-list-item"),Mr=(e,t)=>{l.toggleListItem(e,"unordered-list",t)},Ar=(e,t)=>{l.onTabListItem(e,"unordered-list",t)},qr=(e,t)=>{l.onEnterListItem(e,"unordered-list",t)},ne={elementType:"unordered-list-item",shortcutText:"*",isVoid:!1,isInline:!1,active:Ur,toggle:Mr,onTab:Ar,onEnter:qr};var $r=e=>l.defaultIsActive(e,"paragraph"),Or=e=>{n.changeCurrentNodeType(e,"paragraph")},Vr=(e,t)=>{l.onEnterWithShiftLinebreak(e,t)},wt={elementType:"paragraph",isVoid:!1,isInline:!1,active:$r,toggle:Or,onEnter:Vr};var Dr=e=>l.defaultIsActive(e,"hyperlink"),Kr=(e,t,o)=>{if(t?.actor=="shortcut"&&t.actorShortcutMatch){if(t.actorShortcutMatch.length<3)return;let r=t.actorShortcutMatch[1],i=t.actorShortcutMatch[2];n.createNewNode(e,"hyperlink",{children:[{text:r}],props:{href:i},createFollowingText:" "})}else l.toggleInlineNode(e,"hyperlink",o,[{text:"Link"}])},Gr=(e,t)=>{if(!n.isChildOf(e,"hyperlink"))return n.isSelection(e)?n.wrapNode(e,"hyperlink",t):n.createNewNode(e,"hyperlink",{children:t.children,props:t,voids:!0,createFollowingText:" "});n.changeNearestNodeProps(e,"hyperlink",t)},F={elementType:"hyperlink",shortcutRegex:/\[(.+)]\((.+)\)$/,isVoid:!1,isInline:!0,active:Dr,toggle:Kr,onUpsert:Gr};var Rr=e=>l.defaultIsActive(e,"image"),Wr=(e,t,o)=>{if(t?.actor=="shortcut"&&t.actorShortcutMatch){if(t.actorShortcutMatch.length<3)return;let r=t.actorShortcutMatch[1],i=t.actorShortcutMatch[2];n.createNewNode(e,"image",{props:{src:i,altText:r},createFollowingText:" "})}else l.toggleInlineNode(e,"image",o)},zr=(e,t)=>{let o=n.currentElement(e);o&&(o.type==="image"?n.changeNearestNodeProps(e,"image",t):n.createNewNode(e,"image",{props:t,voids:!0,createFollowingText:" "}))},U={elementType:"image",shortcutRegex:/!\[(.+)]\((.+)\)$/,isVoid:!0,isInline:!0,active:Rr,toggle:Wr,onUpsert:zr};var Zr=e=>l.defaultIsActive(e,"ordered-list-item"),jr=(e,t)=>{l.toggleListItem(e,"ordered-list",t)},Qr=(e,t)=>{l.onTabListItem(e,"ordered-list",t)},Yr=(e,t)=>{l.onEnterListItem(e,"ordered-list",t)},le={elementType:"ordered-list-item",shortcutRegex:/^\d+\.$/,isVoid:!1,isInline:!1,active:Zr,toggle:jr,onTab:Qr,onEnter:Yr};var ie=[K,G,J,X,ee,te,oe,re,U,F,Y,le,wt,Q,ne],D={};ie.forEach(e=>{D[e.elementType]=e});var Se=ie.filter(e=>!e.isInline),Jr={};Se.forEach(e=>{Jr[e.elementType]=e});var se=ie.filter(e=>e.isInline),Xr={};se.forEach(e=>{Xr[e.elementType]=e});var Be=ie.filter(e=>e.isVoid),en={};Be.forEach(e=>{en[e.elementType]=e});var we=a(require("react"));var Fe={container:"ToolbarButtonSpacer-module__container_kEBEkG__030",spacer:"ToolbarButtonSpacer-module__spacer_kEBEkG__030"};var R=()=>we.default.createElement("div",{className:Fe.container},we.default.createElement("div",{className:Fe.spacer}));var jt=require("slate-react");var p=a(require("react"));var $=a(require("react"));var Le={container:"Popover-module__container_dxsL9W__030",innerContainer:"Popover-module__innerContainer_dxsL9W__030"};var Lt=require("usehooks-ts");var ae=e=>{let t=(0,$.useContext)(d),o=(0,$.useRef)(null);(0,Lt.useOnClickOutside)(o,e.onClose);let r=i=>{e.onPressEnter&&i.key==="Enter"&&e.onPressEnter()};return $.default.createElement("div",{className:`${Le.container} ${t?.popover?.containerClassName||""}`},$.default.createElement("div",{className:`${Le.innerContainer} ${e.align} ${t?.popover?.innerContainerClassName||""}`,ref:o,onKeyDown:r},e.children))};var Ue={container:"HyperlinkToolbarButton-module__container_KZEcDq__030",hrefInput:"HyperlinkToolbarButton-module__hrefInput_KZEcDq__030"};var Ee=require("slate-react");var ge=a(require("react"));var Ut={container:"Form-module__container_R0Llbq__030"};var me=a(require("react"));var Mt={container:"FormGroup-module__container_t4ESPW__030"};var ue=e=>{let t=(0,me.useContext)(d);return me.default.createElement("div",{className:`${Mt.container} ${t?.forms?.groupClassName||""}`},e.children)};var de=a(require("react"));var At={label:"FormLabel-module__label_jkwkqq__030"};var qt=e=>{let t=(0,de.useContext)(d);return de.default.createElement("label",{className:`${At.label} ${t?.forms?.labelClassName}`},e.text)};var ce=a(require("react"));var $t={input:"FormInput-module__input_x5oyYq__030"};var Ot=e=>{let t=(0,ce.useContext)(d),o=r=>{e.onChange(r.target.value)};return ce.default.createElement("input",{ref:e.ref,className:`${$t.input} ${e.className||void 0} ${t?.forms?.inputClassName||""}`,value:e.value,onChange:o})};var pe=a(require("react"));var Vt={error:"FormError-module__error_TZXMUq__030"};var Dt=e=>{let t=(0,pe.useContext)(d);return pe.default.createElement("span",{className:`${Vt.error} ${t?.forms?.errorClassName||""}`},e.text)};var fe=a(require("react"));var Kt={container:"FormButtonGroup-module__container_4Hygba__030"};var Gt=e=>{let t=(0,fe.useContext)(d);return fe.default.createElement("div",{className:`${Kt.container} ${t?.forms?.buttonsContainerClassName||""}`},e.children)};var Ce=a(require("react"));var Rt={button:"FormButton-module__button_C8cIaW__030"};var Wt=e=>{let t=(0,Ce.useContext)(d),o=r=>{r.preventDefault()};return Ce.default.createElement("button",{className:`${Rt.button} ${t?.forms?.buttonClassName} ${e.type}`,onClick:e.onClick,onMouseDown:o},e.children)};var c=e=>{let t=(0,ge.useContext)(d);return ge.default.createElement("form",{className:`${Ut.container} ${t?.forms?.containerClassName||""}`},e.children)};c.Group=ue;c.Label=qt;c.Input=Ot;c.Error=Dt;c.ButtonGroup=Gt;c.Button=Wt;var zt=()=>{let e=(0,p.useContext)(d),t=(0,Ee.useSlate)(),[o,r]=(0,p.useState)(!1),[i,C]=(0,p.useState)(""),N=(0,p.useRef)(null);(0,p.useEffect)(()=>{if(!o)return;N.current?.focus();let x=n.nearestElementOfType(t,"hyperlink");if(!x||!x.href)return C("https://niiice.io");C(x.href)},[o,t]);let I=()=>{r(!1),Ee.ReactEditor.focus(t)},B=()=>{r(!o)},w=()=>{F.onUpsert&&(F.onUpsert(t,{href:i,children:[{text:i}]}),I())},_=(0,p.useMemo)(()=>n.isChildOf(t,"hyperlink"),[t.selection]),g=()=>{F.toggle(t),I()},b=()=>{w()};return p.default.createElement("div",{className:Ue.container},p.default.createElement(P,{onClick:B,icon:"hyperlink"}),o&&p.default.createElement(ae,{onClose:I,onPressEnter:b,align:"top-right"},p.default.createElement(c,null,p.default.createElement(c.Group,null,p.default.createElement(c.Label,{text:e?.texts?.url||"Url"}),p.default.createElement(c.Input,{ref:N,value:i,onChange:C,className:Ue.hrefInput})),p.default.createElement(c.ButtonGroup,null,_&&p.default.createElement(c.Button,{type:"danger",onClick:g},e?.texts?.remove||"Remove"),p.default.createElement(c.Button,{type:"primary",onClick:w},e?.texts?.insert||"Insert")))))};var he=require("slate-react"),f=a(require("react"));var Me={container:"ImageToolbarButton-module__container_N6H06G__030",srcInput:"ImageToolbarButton-module__srcInput_N6H06G__030"};var Zt=e=>{let t=(0,f.useContext)(d),o=(0,he.useSlate)(),[r,i]=(0,f.useState)(!1),[C,N]=(0,f.useState)(""),I=(0,f.useRef)(null);(0,f.useEffect)(()=>{if(!r)return;I.current?.focus();let x=n.nearestElementOfType(o,"image");if(!x||!x.src)return N("https://niiice.io/wp-content/uploads/2020/04/niiice-Logo_dark.png");N(x.src)},[r,o]);let B=()=>{i(!1),he.ReactEditor.focus(o)},w=()=>{i(!r)},_=()=>{U.onUpsert&&(U.onUpsert(o,{src:C}),B())},g=()=>{_()},b=()=>{e.onUploadRequest&&(B(),e.onUploadRequest("image/*"))};return f.default.createElement("div",{className:Me.container},f.default.createElement(P,{onClick:w,icon:"image"}),r&&f.default.createElement(ae,{onClose:B,onPressEnter:g,align:"top-right"},f.default.createElement(c,null,f.default.createElement(c.Group,null,f.default.createElement(c.Label,{text:t?.texts?.url||"Url"}),f.default.createElement(c.Input,{ref:I,value:C,onChange:N,className:Me.srcInput})),f.default.createElement(c.ButtonGroup,null,e.onUploadRequest&&f.default.createElement(c.Button,{type:"secondary",onClick:b},t?.texts?.upload||"Upload"),f.default.createElement(c.Button,{type:"primary",onClick:_},t?.texts?.insert||"Insert")))))};var Qt=e=>{let t=(0,jt.useSlate)(),o=(0,h.useContext)(d),r=()=>{q.toggleBold(t)},i=()=>{q.toggleItalic(t)},C=b=>{D[`heading-${b}`].toggle(t,{actor:"toolbar"})},N=()=>{ne.toggle(t,{actor:"toolbar"})},I=()=>{le.toggle(t,{actor:"toolbar"})},B=()=>{K.toggle(t,{actor:"toolbar"})},w=()=>{G.toggle(t,{actor:"toolbar"})},_=()=>{e.onUploadRequest&&e.onUploadRequest(void 0,!0)},g={bold:q.isBoldActive(t),italic:q.isItalicActive(t),"heading-1":J.active(t),"heading-2":X.active(t),"heading-3":ee.active(t),"heading-4":te.active(t),"heading-5":oe.active(t),"heading-6":re.active(t),"unordered-list":Q.active(t),"ordered-list":Y.active(t),blockquote:K.active(t),code:G.active(t),hyperlink:F.active(t)};return h.default.createElement("div",{className:`${Ne.container} ${o?.toolbar?.containerClassName||""}`},h.default.createElement("div",{className:Ne.innerContainer},h.default.createElement(P,{icon:"bold",onClick:r,active:g.bold}),h.default.createElement(P,{icon:"italic",onClick:i,active:g.italic}),h.default.createElement(R,null),[1,2,3,4,5,6].map(b=>h.default.createElement(P,{key:b,onClick:()=>C(b),text:`H${b}`,active:g[`heading-${b}`]})),h.default.createElement(R,null),h.default.createElement(P,{icon:"unordered-list",onClick:N,active:g["unordered-list"]}),h.default.createElement(P,{icon:"ordered-list",onClick:I,active:g["ordered-list"]}),h.default.createElement(R,null),h.default.createElement(P,{icon:"blockquote",onClick:B,active:g.blockquote}),h.default.createElement(P,{icon:"code",onClick:w,active:g.code}),h.default.createElement(R,null),h.default.createElement(zt,null),h.default.createElement(Zt,{onUploadRequest:e.onUploadRequest}),e.onUploadRequest&&h.default.createElement(P,{icon:"upload",onClick:_,active:!1})))};var Ae={container:"MarkdownEditor-module__container_mfJZzW__030",editor:"MarkdownEditor-module__editor_mfJZzW__030"};var be={container:"elements-module__container_bH2TYq__030"};var T=a(require("react"));var qe={fileInput:"UploadModal-module__fileInput_uGKa2W__030",progressBar:"UploadModal-module__progressBar_uGKa2W__030"};var S=a(require("react")),Yt=require("react-icons/io5");var O={bodyContainer:"Modal-module__bodyContainer_QZ8FHq__030",closeButton:"Modal-module__closeButton_QZ8FHq__030",container:"Modal-module__container_QZ8FHq__030",header:"Modal-module__header_QZ8FHq__030",headerContainer:"Modal-module__headerContainer_QZ8FHq__030",innerContainer:"Modal-module__innerContainer_QZ8FHq__030"};var Jt=require("usehooks-ts");var Xt=e=>{let t=(0,S.useContext)(d),o=(0,S.useRef)(null);return(0,Jt.useOnClickOutside)(o,e.onClose),S.default.createElement("div",{className:`${O.container} ${t?.modal?.containerClassName||""}`},S.default.createElement("div",{className:`${O.innerContainer} ${t?.modal?.innerContainerClassName||""}`,ref:o},S.default.createElement("div",{className:`${O.headerContainer} ${t?.modal?.headerContainerClassName||""}`},S.default.createElement("span",{className:O.header},e.title),S.default.createElement("button",{className:O.closeButton,onClick:e.onClose},S.default.createElement(Yt.IoCloseOutline,{size:"1.5rem"}))),S.default.createElement("div",{className:`${O.bodyContainer} ${t?.modal?.bodyContainerClassName||""}`},e.children)))};var eo=e=>{let t=(0,T.useContext)(d),[o,r]=(0,T.useState)(null),[i,C]=(0,T.useState)(null),N=_=>{r(_.message)},I=_=>{C(_)},B=(_,g,b)=>{e.onUploadFinish(_,g,b)};(0,T.useEffect)(()=>{e.uploader.setOnProgressViewCallback(I),e.uploader.setOnErrorViewCallback(N),e.uploader.setOnFinishViewCallback(B)},[e.uploader]);let w=_=>{r(null);let g=_.currentTarget.files;if(!g)return;let b=Array.from(g);if(e.acceptedFileTypes){for(let x of b)if(!tn(x.type,e.acceptedFileTypes))return r(t?.texts?.invalidFileTypeError||"Invalid file type.")}if(e.maxFileSize){for(let x of b)if(x.size>e.maxFileSize)return r(t?.texts?.maxFileSizeError||"File too large.")}C(0);for(let x of b)e.uploader.startUpload(x).then()};return T.default.createElement(Xt,{title:t?.texts?.uploadModalHeaderTitle||"Upload file",onClose:e.onClose},T.default.createElement(c,null,T.default.createElement(ue,null,T.default.createElement("input",{className:qe.fileInput,type:"file",onChange:w,disabled:i!==null}),o&&T.default.createElement(c.Error,{text:o}))),i!==null&&T.default.createElement("progress",{className:qe.progressBar,max:100,value:i*100}))},tn=(e,t)=>(t=t.replace(/\s/g,""),t.split(",").some(r=>{if(r.endsWith("/*")){let i=r.split("/")[0];return e.startsWith(i)}else return r===e}));var $e=a(require("react")),to=e=>$e.default.createElement("span",{contentEditable:!1,...e.attributes},$e.default.createElement("img",{src:e.element.src,alt:e.element.altText||"Image"}),e.children);var oo=a(require("react")),ro=e=>oo.default.createElement("a",{href:e.element.href,...e.attributes},e.children);var no=a(require("react"));var lo=e=>no.default.createElement(d.Provider,{value:e.value},e.children);var io=a(require("react")),so=e=>io.default.createElement("li",{...e.attributes},e.children);var mo=e=>{let[t]=(0,u.useState)(()=>rn(on((0,M.withReact)((0,ao.createEditor)())))),[o,r]=(0,u.useState)({show:!1}),i=(0,u.useRef)([]),C=(0,u.useCallback)(m=>{switch(m.element.type){case"blockquote":return u.default.createElement(Re,{...m});case"code":return u.default.createElement(Ve,{...m});case"heading-1":return u.default.createElement(ze,{...m});case"heading-2":return u.default.createElement(je,{...m});case"heading-3":return u.default.createElement(Ye,{...m});case"heading-4":return u.default.createElement(Xe,{...m});case"heading-5":return u.default.createElement(tt,{...m});case"heading-6":return u.default.createElement(rt,{...m});case"image":return u.default.createElement(to,{...m});case"hyperlink":return u.default.createElement(ro,{...m});case"ordered-list-item":return u.default.createElement(so,{...m});case"ordered-list":return u.default.createElement(lt,{...m});case"unordered-list":return u.default.createElement(st,{...m});case"unordered-list-item":return u.default.createElement(mt,{...m});default:return u.default.createElement(Ke,{...m})}},[]),N=(0,u.useCallback)(m=>u.default.createElement(vt,{...m}),[]),I=m=>{switch(m.key){case"_":case"*":{q.handleBoldAndItalic(t,m);break}case" ":case"Dead":{let E=n.textSinceBlockStart(t);if(!E)break;let H=!1;for(let A of Se)if(E===A.shortcutText||A.shortcutRegex?.test(E)){n.deleteFromLeft(t,E.length),A.toggle(t,{actor:"shortcut",actorShortcut:E}),m.preventDefault(),H=!0;break}if(H||!t.selection)return;for(let A of se){if(!A.shortcutRegex)continue;let z=E.match(A.shortcutRegex);if(z){n.deleteAt(t,{path:t.selection.anchor.path,offset:E.length-z[0].length},z[0].length),A.toggle(t,{actor:"shortcut",actorShortcutMatch:z}),m.preventDefault();break}}break}case"Tab":{let E=n.currentBlockType(t);if(!E)break;let H=D[E].onTab;if(!H)break;H(t,m);break}case"Enter":{let E=n.currentElementType(t);if(!E)break;let H=D[E].onEnter;if(!H)break;H(t,m);break}}},B=m=>{if(t.operations.some(H=>H.type!=="set_selection")){if(i.current=m,!e.onChange)return;e.onChange(m)}},w=m=>{e.onBlur&&(e.onBlur(m,i.current),m.preventDefault())},_=(m,E)=>{r({show:!0,accept:m,forceAttachment:E})},g=()=>{r({show:!1}),M.ReactEditor.focus(t)},b=(m,E,H)=>{if(E.type.includes("image")&&!o.forceAttachment){if(!U.onUpsert)return;U.onUpsert(t,{src:m,metaData:H})}else{if(!F.onUpsert)return;F.onUpsert(t,{children:[{text:E.name}],href:m,metaData:H})}g()},x=(0,u.useMemo)(()=>e.initialValue&&e.initialValue.length>0?e.initialValue:[{type:"paragraph",children:[{text:e.defaultText!==void 0?e.defaultText:""}]}],[e.initialValue,e.defaultText]);return u.default.createElement(lo,{value:e.customStyle},u.default.createElement(M.Slate,{editor:t,initialValue:x,onChange:B},u.default.createElement("div",{className:`${Ae.container} ${e.customStyle?.editor?.containerClassName||""}`},u.default.createElement(Qt,{onUploadRequest:e.uploadInfo?_:void 0}),u.default.createElement(M.Editable,{className:`${Ae.editor} ${be.container} ${e.customStyle?.editor?.editorContainerClassName||""}`,renderElement:C,renderLeaf:N,onKeyDown:I,onBlur:w})),e.uploadInfo&&o.show&&u.default.createElement(eo,{onUploadFinish:b,onClose:g,...e.uploadInfo,acceptedFileTypes:o.accept||e.uploadInfo.acceptedFileTypes})))},on=e=>{let{isInline:t}=e;return e.isInline=o=>se.map(i=>i.elementType).includes(o.type)||t(o),e},rn=e=>{let{isVoid:t}=e;return e.isVoid=o=>Be.map(i=>i.elementType).includes(o.type)||t(o),e};var W=a(require("react"));var uo=(e,t)=>e.filter(o=>o===t).length,co=e=>Array(e*4).join(" "),nn={blockquote:(e,t)=>`> ${v(e.children,[...t,"blockquote"])}
`,code:(e,t)=>`\`\`\`
${v(e.children,[...t,"code"])}
\`\`\`
`,"heading-1":(e,t)=>`# ${v(e.children,[...t,"heading-1"])}
`,"heading-2":(e,t)=>`## ${v(e.children,[...t,"heading-2"])}
`,"heading-3":(e,t)=>`### ${v(e.children,[...t,"heading-3"])}
`,"heading-4":(e,t)=>`#### ${v(e.children,[...t,"heading-4"])}
`,"heading-5":(e,t)=>`##### ${v(e.children,[...t,"heading-5"])}
`,"heading-6":(e,t)=>`###### ${v(e.children,[...t,"heading-6"])}
`,hyperlink:(e,t)=>`[${v(e.children,[...t,"hyperlink"])}](${e.href||""})`,image:(e,t)=>`![${e.altText||""}](${e.src||""})`,"ordered-list":(e,t)=>v(e.children,[...t,"ordered-list"]),"ordered-list-item":(e,t)=>{let o=uo(t,"ordered-list"),r=co(o-1);return r=`${r}1. ${v(e.children,[...t,"ordered-list-item"])}
`,r},paragraph:(e,t)=>`
${v(e.children,[...t,"paragraph"])}
`,"unordered-list":(e,t)=>v(e.children,[...t,"unordered-list"]),"unordered-list-item":(e,t)=>{let o=uo(t,"unordered-list"),r=co(o-1);return r=`${r}* ${v(e.children,[...t,"unordered-list-item"])}
`,r}},ln=e=>{if(!e.text)return"";let t=e.text;return e.bold&&(t=`**${t}**`),e.italic&&(t=`*${t}*`),t},sn=(e,t)=>{let o=nn[e.type];return o?o(e,t):""},an=(e,t)=>{if(n.isLeaf(e))return ln(e);let o=e;return o.type?sn(o,t):""},v=(e,t,o="")=>e?e?.map(r=>an(r,t)).join(o):"",ye=e=>v(e,[]);var po=a(require("react-markdown")),fo=a(require("remark-gfm")),Co=a(require("remark-breaks"));var go=e=>{let t=(0,W.useMemo)(()=>typeof e.value=="string"?e.value:ye(e.value),[e.value]);return W.default.createElement("div",{className:`${be.container} ${e.className||""}`},W.default.createElement(po.default,{remarkPlugins:[fo.default,Co.default]},t))};var _e=class{onProgress(t){this.onProgressViewCallback&&this.onProgressViewCallback(t)}onFinish(t,o,r={}){this.onFinishViewCallback&&this.onFinishViewCallback(t,o,r)}onError(t){this.onErrorViewCallback&&this.onErrorViewCallback(t)}setOnProgressViewCallback(t){this.onProgressViewCallback=t}setOnFinishViewCallback(t){this.onFinishViewCallback=t}setOnErrorViewCallback(t){this.onErrorViewCallback=t}};
//# sourceMappingURL=index.js.map
